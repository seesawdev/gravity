syntax = "proto3";

package installer;

// Agent defines a service to install a cluster
service Agent {
    // Execute runs installer operation to completion
    rpc Execute(ExecuteRequest) returns (stream ProgressResponse);

    // Shutdown requests that the installer exit
    rpc Shutdown(ShutdownRequest) returns (ShutdownResponse);

    // GetProgress polls the server for operation progress
    // rpc GetProgress(ProgressRequest) returns (stream ProgressResponse);

    // Validate allows the engine to prepare for the installation
    // and validate the environment before the operation is executed
    // rpc Validate(ValidateRequest) returns (ValidateResponse);
}

// ExecuteRequest describes a request to execute install operation
message ExecuteRequest {
}

// ExecuteResponse describes the server response to execute request
message ExecuteResponse {
}

// // ValidateRequest describes a request to validate environment before the operation
// message ValidateRequest {
// }
//
// // ValidateResponse describes the server response after validation
// message ValidateResponse {
// }
// // ProgressRequest is a request for stream of progress messages
// message ProgressRequest {
// }

// ShutdownRequest describes a request to shut down the process
message ShutdownRequest {
}

// ShutdownResponse describes the server response to the shut down request
message ShutdownResponse {
}

// ProgressResponse describes a single progress step
message ProgressResponse {
    // Message specifies the progress message
    string message = 1;
    // FIXME: necessary?
    // Complete determines whether the operation is complete
    bool complete = 2;
    // Errors lists errors for this progress step
    repeated Error errors = 3;
}

// Error represents an error in the operation
message Error {
    // Message specifies the error message
    string message = 1;
}
